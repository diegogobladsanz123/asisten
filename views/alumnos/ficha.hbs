<style>
    .checkbox {
        padding-left: 20px;
    }

    .checkbox label {
        display: inline-block;
        position: relative;
        padding-left: 5px;
    }

    .checkbox label::before {
        content: "";
        display: inline-block;
        position: absolute;
        width: 17px;
        height: 17px;
        left: 0;
        margin-left: -20px;
        border: 1px solid #cccccc;
        border-radius: 3px;
        background-color: #fff;
        -webkit-transition: border 0.15s ease-in-out, color 0.15s ease-in-out;
        -o-transition: border 0.15s ease-in-out, color 0.15s ease-in-out;
        transition: border 0.15s ease-in-out, color 0.15s ease-in-out;
    }

    .checkbox label::after {
        display: inline-block;
        position: absolute;
        width: 16px;
        height: 16px;
        left: 0;
        top: 0;
        margin-left: -20px;
        padding-left: 3px;
        padding-top: 1px;
        font-size: 11px;
        color: #555555;
    }

    .checkbox input[type="checkbox"] {
        opacity: 0;
    }

    .checkbox input[type="checkbox"]:focus+label::before {
        outline: thin dotted;
        outline: 5px auto -webkit-focus-ring-color;
        outline-offset: -2px;
    }

    .checkbox input[type="checkbox"]:checked+label::after {
        font-family: 'FontAwesome';
        content: "\f00c";
    }

    .checkbox input[type="checkbox"]:disabled+label {
        opacity: 0.65;
    }

    .checkbox input[type="checkbox"]:disabled+label::before {
        background-color: #eeeeee;
        cursor: not-allowed;
    }

    .checkbox.checkbox-circle label::before {
        border-radius: 50%;
    }

    .checkbox.checkbox-inline {
        margin-top: 0;
    }

    .checkbox-primary input[type="checkbox"]:checked+label::before {
        background-color: #428bca;
        border-color: #428bca;
    }

    .checkbox-primary input[type="checkbox"]:checked+label::after {
        color: #fff;
    }

    .checkbox-danger input[type="checkbox"]:checked+label::before {
        background-color: #d9534f;
        border-color: #d9534f;
    }

    .checkbox-danger input[type="checkbox"]:checked+label::after {
        color: #fff;
    }

    .checkbox-info input[type="checkbox"]:checked+label::before {
        background-color: #5bc0de;
        border-color: #5bc0de;
    }

    .checkbox-info input[type="checkbox"]:checked+label::after {
        color: #fff;
    }

    .checkbox-warning input[type="checkbox"]:checked+label::before {
        background-color: #f0ad4e;
        border-color: #f0ad4e;
    }

    .checkbox-warning input[type="checkbox"]:checked+label::after {
        color: #fff;
    }

    .checkbox-success input[type="checkbox"]:checked+label::before {
        background-color: #5cb85c;
        border-color: #5cb85c;
    }

    .checkbox-success input[type="checkbox"]:checked+label::after {
        color: #fff;
    }

    .radio {
        padding-left: 20px;
    }

    .radio label {
        display: inline-block;
        position: relative;
        padding-left: 5px;
    }

    .radio label::before {
        content: "";
        display: inline-block;
        position: absolute;
        width: 17px;
        height: 17px;
        left: 0;
        margin-left: -20px;
        border: 1px solid #cccccc;
        border-radius: 50%;
        background-color: #fff;
        -webkit-transition: border 0.15s ease-in-out;
        -o-transition: border 0.15s ease-in-out;
        transition: border 0.15s ease-in-out;
    }

    .radio label::after {
        display: inline-block;
        position: absolute;
        content: " ";
        width: 11px;
        height: 11px;
        left: 3px;
        top: 3px;
        margin-left: -20px;
        border-radius: 50%;
        background-color: #555555;
        -webkit-transform: scale(0, 0);
        -ms-transform: scale(0, 0);
        -o-transform: scale(0, 0);
        transform: scale(0, 0);
        -webkit-transition: -webkit-transform 0.1s cubic-bezier(0.8, -0.33, 0.2, 1.33);
        -moz-transition: -moz-transform 0.1s cubic-bezier(0.8, -0.33, 0.2, 1.33);
        -o-transition: -o-transform 0.1s cubic-bezier(0.8, -0.33, 0.2, 1.33);
        transition: transform 0.1s cubic-bezier(0.8, -0.33, 0.2, 1.33);
    }

    .radio input[type="radio"] {
        opacity: 0;
    }

    .radio input[type="radio"]:focus+label::before {
        outline: thin dotted;
        outline: 5px auto -webkit-focus-ring-color;
        outline-offset: -2px;
    }

    .radio input[type="radio"]:checked+label::after {
        -webkit-transform: scale(1, 1);
        -ms-transform: scale(1, 1);
        -o-transform: scale(1, 1);
        transform: scale(1, 1);
    }

    .radio input[type="radio"]:disabled+label {
        opacity: 0.65;
    }

    .radio input[type="radio"]:disabled+label::before {
        cursor: not-allowed;
    }

    .radio.radio-inline {
        margin-top: 0;
    }

    .radio-primary input[type="radio"]+label::after {
        background-color: #428bca;
    }

    .radio-primary input[type="radio"]:checked+label::before {
        border-color: #428bca;
    }

    .radio-primary input[type="radio"]:checked+label::after {
        background-color: #428bca;
    }

    .radio-danger input[type="radio"]+label::after {
        background-color: #d9534f;
    }

    .radio-danger input[type="radio"]:checked+label::before {
        border-color: #d9534f;
    }

    .radio-danger input[type="radio"]:checked+label::after {
        background-color: #d9534f;
    }

    .radio-info input[type="radio"]+label::after {
        background-color: #5bc0de;
    }

    .radio-info input[type="radio"]:checked+label::before {
        border-color: #5bc0de;
    }

    .radio-info input[type="radio"]:checked+label::after {
        background-color: #5bc0de;
    }

    .radio-warning input[type="radio"]+label::after {
        background-color: #f0ad4e;
    }

    .radio-warning input[type="radio"]:checked+label::before {
        border-color: #f0ad4e;
    }

    .radio-warning input[type="radio"]:checked+label::after {
        background-color: #f0ad4e;
    }

    .radio-success input[type="radio"]+label::after {
        background-color: #5cb85c;
    }

    .radio-success input[type="radio"]:checked+label::before {
        border-color: #5cb85c;
    }

    .radio-success input[type="radio"]:checked+label::after {
        background-color: #5cb85c;
    }
</style>



<div class="modal fade" id="modal-id--">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title">Modal title</h4>
            </div>
            <div class="modal-body">

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Save changes</button>
            </div>
        </div>
    </div>
</div>
<!--TODO:MODALPRINT-->
<div class="modal fade" id="modal_print">
    <div class="modal-dialog">
        <div class="modal-content">

            <form action="/reportsPDF/ficha/{{alumno.idalumno}}" class="ui form" id="getFicha" method="POST">

                <div class="modal-body">
                    <div class="ui dividing header">Periodo de búsqueda</div>
                    <div class="ui error message"></div>
                    <div class="field">
                        <label for="">Fecha desde</label>
                        <div class="input-group date" data-provide="datepicker">
                            <input type="text" class="form-control" name="fecha_desde" value="">
                            <div class="input-group-addon">
                                <span class="glyphicon glyphicon-th"></span>
                            </div>
                        </div>
                    </div>
                    <div class="field">
                        <label for="">Fecha hasta</label>
                        <div class="input-group date" data-provide="datepicker">
                            <input type="text" class="form-control" name="fecha_hasta" value="">
                            <div class="input-group-addon">
                                <span class="glyphicon glyphicon-th"></span>
                            </div>
                        </div>
                    </div>
                    <div class="ui dividing header">Añadir al reporte</div>
                    <!--
                        1 = inasistencias
                        2 = novedades
                        3 = notificaciones
                    -->
                    <div class="field">
                        <div class="checkbox checkbox-success">
                            <input id="checkbox1" type="checkbox" name="op_visualizacion[]" value="1">
                            <label for="checkbox1">
                                Inasistencias
                            </label>
                        </div>
                    </div>
                    <div class="field">
                        <div class="checkbox checkbox-success">
                            <input id="checkbox2" type="checkbox" name="op_visualizacion[]" value="2">
                            <label for="checkbox2">
                                Novedades
                            </label>
                        </div>
                    </div>
                    {{!--  <div class="field">
                        <div class="checkbox checkbox-success">
                            <input id="checkbox3" type="checkbox" name="op_visualizacion[]" value="3">
                            <label for="checkbox3">
                                Notificaciónes
                            </label>
                        </div>
                    </div> --}}
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                    <button type="submit" class="btn btn-primary">Generar</button>
                </div>
            </form>
        </div>
    </div>
    <script>
        $(() => {
            $('#getFicha').form({
                fields: {
                    fecha_desde: {
                        identifier: 'fecha_desde',
                        rules: [{ type: 'empty', prompt: 'Seleccione la fecha' }]
                    },
                    op_visualizacion: {
                        identifier: 'op_visualizacion[]',
                        rules: [{ type: 'checked', prompt: 'Seleccione una de las opciónes para añadir al reporte' }]
                    }
                }, onSuccess: (e) => {
                    e.submit();
                }
            }).submit((e) => {
                e.preventDefault();
            })
        })
    </script>
</div>
<!--END:MODALPRINT-->
<div class="col-md-12">
    <!-- Widget: user widget style 1 -->
    <div class="box box-widget widget-user">
        <!-- Add the bg color to the header using any of the bg-* classes -->
        <div class="widget-user-header bg-blue"
            {{!-- style="background: url('/images/OAYT680.jpg') center center;" --}}>

            <a class="btn btn-default pull-right" data-toggle="modal" href='#modal_print'><i class="fa fa-download"></i>
                Generar reporte</a>


            <h3 class="widget-user-username">UNIDAD EDUCATIVA "DOCE DE MAYO"</h3>
            <h5 class="widget-user-desc">FICHA INDIVIDUAL DEL ESTUDIANTE</h5>
            <code>{{#anioLectivo user.username user.mapa2}}{{/anioLectivo}}</code>
            <br><br><br>
        </div>
        <div class="widget-user-image">
            <img class="img-circle" src="/images/doce-Logo.png" alt="User Avatar">
        </div>
        <div class="box-footer">
            <div class="row">
                <div class="col-sm-6 border-right">

                    <div class="ui divided selection list">

                        <a class="item">
                            <div class="ui basic blue horizontal label">APELLIDOS Y NOMBRES:</div>
                            {{alumno.alu_apellidos_nombres}}
                        </a>
                        <a class="item">
                            <div class="ui basic blue horizontal label">DOMICILIO:</div>
                            {{alumno.alu_direccion}}
                        </a>
                        <a class="item">
                            <div class="ui basic blue horizontal label">REPRESENTANTE:</div>
                            {{alumno.alu_representante_nombres}}
                            <div class="ui basic blue horizontal label">TELÉFONO:</div>
                            {{alumno.alu_representante_telefono}}
                        </a>
                    </div>




                    {{!-- <div class="description-block">                        
                        <h5 class="description-header">3,200</h5>
                        <span class="description-text">SALES</span>
                    </div> --}}
                    <!-- /.description-block -->
                </div>
                <div class="col-sm-6 border-right">
                    <div class="ui divided selection list">
                        <a class="item">

                        </a>

                        <a class="item">
                            <div class="ui basic blue horizontal label">NIVEL:</div>
                            {{alumno.niv_nivel}}
                            <div class="ui basic blue horizontal label">CURSO:</div>
                            {{alumno.cur_curso}}


                        </a>
                        <a class="item">
                            <div class="ui basic blue horizontal label">TUTOR:</div>
                            {{tutor.fun_nombres}}
                        </a>
                        {{!-- <a class="item">
                            <div class="ui basic blue horizontal label">REPRESENTANTE:</div>
                            {{alumno.alu_representante_nombres}}
                        </a> --}}
                    </div>
                    {{!-- <div class="description-block">                        
                                            <h5 class="description-header">3,200</h5>
                                            <span class="description-text">SALES</span>
                                        </div> --}}
                    <!-- /.description-block -->
                </div>
                <!-- /.col -->


            </div>
            <!-- /.row -->
        </div>



        {{!-- TODO://tabls - - - - - - - - - - - - - - - - -  --}}
        <div class="nav-tabs-custom">
            <ul class="nav nav-tabs">
                <li class="active"><a href="#tab_1" data-toggle="tab" aria-expanded="true"><i
                            class="fa fa-home"></i>Inicio</a></li>
                <li class=""><a href="#tab_2" data-toggle="tab" aria-expanded="false">Inasistencias</a></li>
                <li class=""><a href="#tab_3" data-toggle="tab" aria-expanded="false">Novedades</a></li>
                <li class=""><a href="#tab_4" data-toggle="tab" aria-expanded="false">Notificaciónes</a></li>



                <a class="btn btn-primary btn-xs pull-right" data-toggle="modal" href='#modal-id-info-ficha'>Info.</a>
                <div class="modal fade" id="modal-id-info-ficha">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal"
                                    aria-hidden="true">&times;</button>
                                <h4 class="modal-title">Información de Ficha Estudiantil</h4>
                            </div>
                            <div class="modal-body">
                                <p>
                                    La ficha estudiantil esta distribuida en los siguientes apartados:
                                </p>
                                <p>
                                    <b>1.-</b> <i class="fa fa-home"></i> <b>Inicio</b>: Vista rápida de las asignaturas
                                    y
                                    porcentaje de inasistencias que el estudiante registra. <br>
                                    <br>
                                    <b>2.-</b> <b>Inasistencias:</b> Presenta el detalle de inasistencias y la
                                    posibilidad de justificar y eliminar.</li>

                                    <b>Nota:</b> La opción <b>Eliminar</b> únicamente deshabilita el registro,
                                    lo que significa que no sera contabilizado en el porcentaje de faltas, pero quedara
                                    va a
                                    quedar el registro histórico de la base de datos.

                                </p>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                            </div>
                        </div>
                    </div>
                </div>

                {{#btnAddNotificacion user.addNotif '#modal-notificacion' anio_state}}{{/btnAddNotificacion}}
                {{#btnAddNovedad user.addNovedad '#modal-novedad' anio_state}}{{/btnAddNovedad}}
                {{#btnAddInasistencia user.addInasistencia '#modal-falta' anio_state}}{{/btnAddInasistencia}}

                <!-- TODO:modal setFaltas -->

                <div class="modal fade" id="modal-falta">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal"
                                    aria-hidden="true">&times;</button>
                                <h4 class="modal-title">Registrar inasistencia</h4>
                                <span class="small">Alumno: <code>{{alumno.alu_apellidos_nombres}}</code></span>

                            </div>
                            {{!-- FIXME:INICIO TABLA --}}

                            <form action="" name="frm-inasistencia" id="frm-inasistencia" class="ui form">

                                <div class="ui error message"></div>
                                <div class="">
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="field">
                                                <label for="">Materia</label>

                                                <select name="materias_has_curso_idmaterias_has_curso"
                                                    class="ui fluid search dropdown" id="slct-materia">
                                                    <option value="" selected>Seleccione...</option>
                                                    {{#each materias}}
                                                    <option value="{{idmaterias_has_curso}}">{{mat_nombre}}
                                                    </option>
                                                    {{/each}}
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="field">
                                                <label for="">Horas</label>
                                                <div class="ui fluid search dropdown selection"><select name=""
                                                        id="slct-hora">
                                                        <option value="">Seleccione...</option>
                                                        <option value="1">1 Hora</option>
                                                        <option value="2">2 Horas</option>
                                                    </select><i class="dropdown icon"></i><input class="search"
                                                        autocomplete="off" tabindex="0">
                                                    <div class="default text">Seleccione...</div>
                                                    <div class="menu" tabindex="-1">
                                                        <div class="item" data-value="1">1 Hora</div>
                                                        <div class="item" data-value="2">2 Horas</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="field">
                                                <label for="">Comentario</label>
                                                <div class="ui action input">
                                                    <input type="text" placeholder="Comentario..." id="inpt-comentario">
                                                    <button type="submit" class="ui icon teal button">
                                                        <i class="add icon"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>

                            {{!-- FIXME:END TABLA --}}

                            <form action="/inspeccion/faltas" method="post" id="form_falta_{{alumno.idalumno}}"
                                class="ui form">
                                <div class="modal-body">
                                    <table class="ui table">
                                        <thead>
                                            <tr>
                                                <th>Materia</th>
                                                <th width="10px">Horas</th>
                                                <th>Comentario</th>
                                                <th></th>
                                            </tr>
                                        </thead>
                                        <tbody id="table-ina">

                                        </tbody>

                                    </table>

                                    <input type="hidden" name="alumno_idalumno" value="{{alumno.idalumno}}" readonly>

                                    <div class="field">
                                        <label for="">Fecha</label>
                                        <input type="date" name="ina_fecha">
                                    </div>


                                    <input type="hidden" readonly name="user_fullname" value="{{user.fullname}}">



                                    <div class="ui error message"></div>
                                </div>



                                <input type="hidden" name="curso" value="{{alumno.cur_curso}}" readonly>
                                <div class="modal-footer">
                                    <span class="btn btn-default" onclick="clearFormFalta({{alumno.idalumno}});"><i
                                            class="fa fa-eraser"></i>
                                        Limpiar</span>
                                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                                    <button type="submit" class="btn btn-primary">Guardar</button>
                                </div>
                            </form>
                        </div>
                        <script type="text/javascript">

                            $('#materias_has_curso_idmaterias_has_curso_{{alumno.idalumno}}').change(function (e) {
                                $(`#materia-{{alumno.idalumno}}`).val($('#materias_has_curso_idmaterias_has_curso_{{alumno.idalumno}} option:selected').text());

                            });

                            function clearFormFalta(id) {
                                $(`#form_falta_${id}`).form('reset');
                            }
                            $(() => {
                                $(`#form_falta_{{alumno.idalumno}}`).form({
                                    fields: {
                                        materias_has_curso_idmaterias_has_curso: {
                                            identifier: "materias_has_curso_idmaterias_has_curso",
                                            rules: [{ type: "empty", prompt: 'Seleccione la materia.' }]
                                        },
                                        materia: {
                                            identifier: "materia",
                                            rules: [{ type: "empty", prompt: 'Seleccione la materia.' }]
                                        },
                                        ina_fecha: {
                                            identifier: 'ina_fecha',
                                            rules: [{ type: 'empty', prompt: 'Seleccione la fecha.' }]
                                        },
                                        horas: {
                                            identifier: 'horas',
                                            rules: [{ type: 'empty', prompt: 'El campo horas es requerido.' }]
                                        }
                                    },
                                    onSuccess: function (e) {
                                        if ($('#table-ina >tr').length == 0) {
                                            alert("Ingrese las materias");
                                            return false;
                                        } else {
                                            e.submit();
                                        }

                                    }
                                }).submit(function (e) {
                                    e.preventDefault();
                                });
                            });

                        </script>
                    </div>
                </div>
                {{!-- END:modal setFaltas --}}
                <!-- TODO:Modal-notificacion -->

                <div class="modal fade" id="modal-notificacion">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal"
                                    aria-hidden="true">&times;</button>
                                <h4 class="modal-title">Registrar notificación</h4>
                            </div>
                            <form action="/notificacion" method="POST" class="ui form" id="form-notificacion">
                                <div class="modal-body">

                                    <div class="field">
                                        <div class="ui left icon input focus">
                                            <input type="text" value="{{alumno.alu_apellidos_nombres}}" readonly>
                                            <i class="user icon"></i>
                                            <input type="hidden" name="alumno_idalumno" value="{{alumno.idalumno}}"
                                                readonly="">
                                        </div>
                                        <div class="field">
                                            <label for="">Curso</label>
                                            <input type="text" name="not_curso" value="{{alumno.cur_curso}}" readonly>
                                        </div>
                                        <div class="two fields">
                                            <div class="field">
                                                <label for="">Fecha registro.</label>


                                                <div class="input-group date" data-provide="datepicker">
                                                    <input type="text" class="form-control" name="not_fecha" value=""
                                                        id="not_fecha">
                                                    <div class="input-group-addon">
                                                        <span class="glyphicon glyphicon-th"></span>
                                                    </div>
                                                </div>


                                            </div>
                                            <div class="field">
                                                <label for="">Tutor</label>
                                                <input type="text" value="{{tutor.fun_nombres}}" name="not_tutor"
                                                    readonly>
                                            </div>

                                        </div>





                                        <div class="field">
                                            <!--TODO_ fecha presentación -->
                                            <label for="">Fecha de presentación.</label>

                                            <div class="input-group date" data-provide="datepicker">
                                                <input type="text" class="form-control" name="not_fecha_presentacion"
                                                    value="">
                                                <div class="input-group-addon">
                                                    <span class="glyphicon glyphicon-th"></span>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="field">
                                            <label for="">Asunto:</label>
                                            <div class="inline field">
                                                <div class="ui checkbox">
                                                    <input type="checkbox" name="nov_asunto[]" tabindex="0"
                                                        class="hidden" value="Justificar faltas">
                                                    <label>Justificar faltas</label>
                                                </div><br>
                                            </div>
                                            <div class="inline field">
                                                <div class="ui checkbox">
                                                    <input type="checkbox" name="nov_asunto[]"
                                                        value="Solucionar asuntos disciplinarios" tabindex="0"
                                                        class="hidden">
                                                    <label>Solucionar asuntos disciplinarios</label>
                                                </div><br>
                                            </div>
                                            <div class="inline field">
                                                <div class="ui checkbox">
                                                    <input type="checkbox" name="nov_asunto[]" value="Otros"
                                                        tabindex="0" class="hidden">
                                                    <label>Otros</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="ui error message"></div>
                                    </div>

                                </div>
                                <div class="modal-footer">
                                    <span class="btn btn-default" onclick="clearFormNotificacion();"><i
                                            class="fa fa-eraser"></i>
                                        Limpiar</span>
                                    <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                                    <button type="submit" class="btn btn-primary">Guardar</button>
                                </div>
                            </form>
                            <script>
                                function clearFormNotificacion() {
                                    $(`#form-notificacion`).form('reset');
                                }
                                $(() => {
                                    $('#form-notificacion').form({
                                        fields: {
                                            not_fecha: {
                                                identifier: 'not_fecha',
                                                rules: [{ type: 'empty', prompt: 'Seleccione la fecha.' }]
                                            },
                                            not_tutor: {
                                                identifier: 'not_tutor',
                                                rules: [{ type: 'empty', prompt: 'El curso no tiene asignado un tutor.' }]
                                            },
                                            nov_asunto: {
                                                identifier: 'nov_asunto[]',
                                                rules: [{ type: 'checked', prompt: 'Seleccione el asunto.' }]
                                            },
                                            not_fecha_presentacion: {
                                                identifier: 'not_fecha_presentacion',
                                                rules: [{ type: 'empty', prompt: 'Seleccione la fecha de presentación.' }]
                                            }
                                        }, onSuccess: (e) => {
                                            e.submit();
                                        }
                                    }).submit((e) => {
                                        e.preventDefault();
                                    })
                                })
                            </script>
                        </div>
                    </div>
                </div>

                <!-- End-Modal-notificacion -->


                {{!-- TODO:novedad --}}
                <div class="modal fade" id="modal-novedad">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal"
                                    aria-hidden="true">&times;</button>
                                <h4 class="modal-title">Registrar novedad</h4>
                            </div>
                            <form action="/inspeccion/novedades" method="post" id="form_novedad_{{alumno.idalumno}}"
                                class="ui form">
                                <div class="modal-body">
                                    <label for="">Alumno.</label>
                                    <div class="field">
                                        <div class="ui left icon input focus">
                                            <input type="text" value="{{alumno.alu_apellidos_nombres}}" readonly>
                                            <i class="user icon"></i>
                                            <input type="hidden" name="alumno_idalumno" value="{{alumno.idalumno}}"
                                                readonly>

                                        </div>
                                    </div>

                                    <div class="field">
                                        <label for="">Materia</label>
                                        <span class="small"><i class="fa fa-info-circle"></i> Si la novedad no sucedió dentro de una hora clase, no es necesario seleccionar esta opción.</span>
                                        <select id="nov_materias_has_curso_idmaterias_has_curso_{{idalumno}}"
                                            name="nov_materias_has_curso_idmaterias_has_curso"
                                            class="ui fluid search dropdown">
                                            <option value="" selected>Seleccione...</option>
                                            {{#each materias}}
                                            <option value="{{idmaterias_has_curso}}">{{mat_nombre}}</option>
                                            {{/each}}
                                        </select>
                                    </div>
                                    <input type="hidden" id="nov_materia-{{idalumno}}" name="nov_materia" readonly>
                                    <div class="field">
                                        <label for="">Fecha</label>
                                        <input type="date" name="nov_fecha">
                                    </div>

                                    <div class="field">
                                        <label for="">Tipo</label>
                                        <select class="ui dropdown" name="nov_tipo" id="">
                                            <option value="" selected>Seleccione...</option>
                                            <option value="1">Otros</option>
                                            <option value="2">Atraso</option>
                                        </select>
                                    </div>
                                    <div class="field">
                                        <label>Asunto</label>
                                        <textarea rows="2" style="height: 50px;" name="nov_asunto"></textarea>
                                    </div>
                                    <div class="ui error message"></div>
                                </div>
                                <div class="modal-footer">
                                    <span class="btn btn-default" onclick="clearFormNovedad({{alumno.idalumno}});"><i
                                            class="fa fa-eraser"></i>
                                        Limpiar</span>
                                    <input type="hidden" readonly value="{{alumno.cur_curso}}" name="not_curso">
                                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                                    <button type="submit" class="btn btn-primary">Guardar</button>
                                </div>
                            </form>
                        </div>
                        <script type="text/javascript">

                            $('#nov_materias_has_curso_idmaterias_has_curso_{{idalumno}}').change(function (e) {
                                $(`#nov_materia-{{idalumno}}`).val($('#nov_materias_has_curso_idmaterias_has_curso_{{idalumno}} option:selected').text());

                            });

                            function clearFormNovedad(id) {
                                $(`#form_novedad_${id}`).form('reset');

                            }
                            $(() => {
                                $(`#form_novedad_{{alumno.idalumno}}`).form({
                                    fields: {
                                        ina_fecha: {
                                            identifier: 'nov_fecha',
                                            rules: [{ type: 'empty', prompt: 'Seleccione la fecha.' }]
                                        },
                                        nov_tipo: {
                                            identifier: 'nov_tipo',
                                            rules: [{ type: 'empty', prompt: 'Seleccione el tipo de novedad.' }]
                                        },
                                        nov_asunto: {
                                            identifier: 'nov_asunto',
                                            rules: [{ type: 'empty', prompt: 'Ingrese el asunto.' }]
                                        }
                                    },
                                    onSuccess: function (e) {
                                        e.submit();
                                    }
                                }).submit(function (e) {
                                    e.preventDefault();
                                });
                            });

                        </script>
                    </div>
                </div>

                {{!-- END:novedad --}}

            </ul>
            <div class="tab-content">
                <div class="tab-pane active" id="tab_1">
                    <div class="row">
                        <p class="text-center">
                            <strong>Porcentaje de faltas</strong>
                        </p>

                        {{#each materias}}
                        <div class="col-md-4">

                            <div class="ui floating message">
                                <div class="progress-group">
                                    <span class="progress-text">{{mat_nombre}}</span>

                                    <span class="progress-number">

                                        {{#each ../agrupado}}
                                        {{#ifeq ../materias_idmaterias id}}
                                        {{../total}}/{{../tenpercent}}</span>
                                    {{#mayorOigual ../total ../tenpercent}}


                                    <div class="ui red message">
                                        <i class="fas fa-exclamation-triangle"></i> El estudiante excedió el limite de
                                        faltas.
                                    </div>
                                    {{/mayorOigual}}
                                    {{/ifeq}}

                                    {{/each}}

                                    {{#each ../agrupado}}
                                    {{#ifeq ../materias_idmaterias id}}


                                    <br><small>Porcentaje de faltas:
                                        <code>{{#calcPercentFaltas ../total ../tenpercent}}{{/calcPercentFaltas}} %</code></small>


                                    <div class="progress" style="background-color:darkgray">
                                        <div class="progress-bar progress-bar-striped active" role="progressbar"
                                            aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"
                                            style="width:{{#calcPercentFaltas ../total ../tenpercent}}{{/calcPercentFaltas}}%">
                                            {{#calcPercentFaltas ../total ../tenpercent}}{{/calcPercentFaltas}}
                                            %
                                        </div>
                                    </div>




                                    {{/ifeq}}

                                    {{/each}}





                                </div>
                            </div>
                        </div>
                        {{/each}}






                    </div>
                </div>
                <!-- /.tab-pane -->
                <div class="tab-pane" id="tab_2">
                    {{!-- TODO:Tab faltas --}}
                    {{> tableFichaInasistencias}}

                    {{!-- END:Tab faltas --}}
                </div>
                <!-- /.tab-pane -->
                <div class="tab-pane" id="tab_3">
                    {{!-- TODO:tab novedades --}}
                    {{>tableFichaNovedades}}
                    {{!-- END:tab novedades --}}
                </div>
                <!-- /.tab-pane -->
                <div class="tab-pane" id="tab_4">

                    <!--TODO: tabla notificaciónes-->
                    {{>tableFichaNotificaciones}}
                    <!--END: tabla notificaciónes-->


                </div>
            </div>
            <!-- /.tab-content -->
        </div>


    </div>
    <!-- /.widget-user -->
</div>
<script type="text/javascript">
    $(document).ready(() => {
        $('.menu .item').tab();
        $('#tbl_alumnos').DataTable({
            "order": [[0, "desc"]],
        });
        $('#tbl_novedades').DataTable({
            'order': [[0, 'desc']]
        });
        $('#tbl-notificacion').DataTable({
            'order': [[0, 'desc']]
        });

        $('[data-toggle="popover"]').popover();
        $('.ui.dropdown').dropdown();
        $('.ui.checkbox').checkbox();

        //dar formato al datepiker
        $('.input-group.date').datepicker({
            todayHighlight: true,
            format: 'yyyy-mm-dd',
            language: "es",
            orientation: "bottom left",
            autoclose: true
        });

        var hoy = new Date();
        var dd = hoy.getDate();
        var mm = hoy.getMonth() + 1;
        var yyyy = hoy.getFullYear();


        if (dd < 10) {
            dd = '0' + dd;
        }

        if (mm < 10) {
            mm = '0' + mm;
        }
        hoy = dd + '/' + mm + '/' + yyyy;
        $('#not_fecha').val(hoy);
        $('')
    })

    /*TODO: JS añadir inasistencias*/
    class Inasistencia {
        constructor(idmateria, materia, horas, comentario) {
            this.idmateria = idmateria;
            this.materia = materia;
            this.horas = horas;
            this.comentario = comentario;
        }
    }

    class UI {
        addInasistencia(inasistencia) {

            let tablebody = `
            <tr>
                <td>
                    <input type="hidden" name="materias_has_curso_idmaterias_has_curso[]" id="" value="${inasistencia.idmateria}" readonly>                                                                    
                    <input type="text" name="materia[]" id="" value="${inasistencia.materia}" readonly>                                                                    
                </td>
                <td>
                    <input type="text" name="horas[]" value="${inasistencia.horas}" readonly>
                </td>
                 <td>
                    <input type="text" name="ina_injust_comment[]" value="${inasistencia.comentario}" readonly>
                </td>
                <td>
                    <span class="btn btn-xs btn-danger" id=""><i class="fa fa-times" id="eliminar"></i></span>
                </td>
             </tr>
            `;


            let table = document.getElementById('table-ina');
            table.innerHTML += tablebody;

            $('#frm-inasistencia').form('clear');

        }
        deleteInasistencia(e) {
            if (e.id === 'eliminar') {
                e.parentElement.parentElement.parentElement.remove();
            }


        }
        showMessage() {

        }
    }
    /*END: JS añadir inasistencias*/


    function enviarInasistencias() {

        if ($('#table-ina >tr').length == 0) {
            alert("Ingrese las materias");
            return false;
        } else {
            return true;
        }
    }



    $(() => {
        $('#frm-inasistencia').form({
            fields: {
                materia: {
                    identifier: 'slct-materia',
                    rules: [{ type: 'empty', prompt: 'Seleccione la materia' }]
                },
                hora: {
                    identifier: 'slct-hora',
                    rules: [{ type: 'empty', prompt: 'Cuantas horas falto' }]
                },


            }, onSuccess: function (e) {
                let idmateria = $('#slct-materia option:selected').val();
                let materia = $('#slct-materia option:selected').text();
                let horas = $('#slct-hora option:selected').val();
                let comentario = $('#inpt-comentario').val();

                let inasistencia = new Inasistencia(idmateria, materia, horas, comentario);

                let ui = new UI();
                ui.addInasistencia(inasistencia);

                document.getElementById('table-ina').addEventListener('click', function (e) {
                    ui.deleteInasistencia(e.target);
                })
            }
        }).submit(function (e) {
            e.preventDefault();
        })
    })





</script>